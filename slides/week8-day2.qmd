---
title: "Inference for One-way ANOVA"
format: 
  revealjs:
    theme: style.scss
editor: source
---

```{r}
#| label: set-up

library(tidyverse)
library(infer)
library(moderndive)
library(lterdatasampler)
library(palmerpenguins)

my_theme <- theme(axis.title.x = element_text(size = 18), 
                  axis.title.y = element_text(size = 18), 
                  axis.text.x = element_text(size = 12), 
                  axis.text.y = element_text(size = 12), 
                  legend.text = element_text(size = 12), 
                  legend.title = element_text(size = 18))
```

## Lab 7 Recap

**Question 6** (Bootstrap Distribution):

-   Did not use an informative axis label

</br>

**Question 8** (Interpret Confidence Interval):

-   Did not include population in interpretation
-   Stated interval was about "all marshes" (no geographical information)


# Statistical Critique 2

## First Steps

1.  Open the directions!
2.  Copy the Statistical Critique template on Posit Cloud
3.  Copy-and-paste code from your Midterm Project
4.  Copy-and-paste your justification for why you chose the model you chose

## Next Steps

4.  Fit the most complex model
5.  Obtain an ANOVA table of your model
6.  Use the p-values in the ANOVA table to decide what model is best

## What is the "most complex" model?

**For 1 numerical & 1 categorical explanatory variables**

-   Fit the **different slopes** (interaction) model

```{r}
#| label: diff-slopes-fit
#| echo: true
#| code-line-numbers: false

species_lm <- lm(bill_length_mm ~ bill_depth_mm * species, 
                  data = penguins)
```

. . .

</br>

**For 2 numerical explanatory variables**

-   Fit the model with **both** variables included:

```{r}
#| label: mlr-fit
#| echo: true
#| code-line-numbers: false

bill_lm <- lm(bill_length_mm ~ body_mass_g + bill_depth_mm, 
                  data = penguins)
```

## How do I know what model is "best" from the ANOVA table?

**For 1 numerical & 1 categorical explanatory variables**

-   Look at the interaction line (e.g., `bill_depth_mm:species`), it is testing if the slopes are different!

```{r}
#| label: diff-slopes-anova
#| echo: true
#| eval: false
#| code-line-numbers: false

anova(species_lm)
```

```{r}
anova(species_lm) %>% 
  broom::tidy() %>%
  rename(`F value` = statistic, 
         `Pr(>F)` = p.value, 
         Df = df, 
         `Sum Sq` = sumsq, 
         `Mean Sq` = meansq) %>% 
  gt::gt()
```

## 

::: {style="font-size: 2em; color: #000000;"}
`bill_depth_mm:species`: With a p-value of 0.0000189, I would conclude there is evidence that the slopes are different!
:::

## How do I know what model is "best" from the ANOVA table?

**For 2 numerical explanatory variables**

-   Look at the p-value for each variable, it is testing if that variable has a relationship with the response (conditional on the other variable being in the model)!

```{r}
#| label: mlr-anova
#| echo: true
#| eval: false
#| code-line-numbers: false

anova(bill_lm)
```

```{r}
anova(bill_lm) %>% 
  broom::tidy() %>%
  rename(`F value` = statistic, 
         `Pr(>F)` = p.value, 
         Df = df, 
         `Sum Sq` = sumsq, 
         `Mean Sq` = meansq) %>% 
  gt::gt()
```

## 

::: {style="font-size: 1.25em; color: #000000;"}
`body_mass_g`: With a p-value of approximately 0, I would conclude there is a relationship between body mass and bill length (after accounting for bill depth)!
:::

</br>

::: {style="font-size: 1.25em; color: #000000;"}
`bill_depth_mm`: With a p-value of 0.234, I would conclude there is not a relationship between bill depth and bill length (after accounting for body mass)!
:::

## ![](images/gapminder.png)

> What is the relationship between life expectancy GDP per capita?

. . .

-   Decide on a variable transformation
-   Assess model conditions (L, I, N, E)
-   Compare hypothesis test results between simulation-based methods and theory-based methods

